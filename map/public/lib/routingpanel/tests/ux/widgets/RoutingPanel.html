<html>
<head>
    <title>Routing Panel Test</title>
    <script type="text/javascript" src="http://svn.geoext.org/ext/3.1.0/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="http://svn.geoext.org/ext/3.1.0/ext-all.js"></script>
    <link rel="stylesheet" type="text/css" href="http://svn.geoext.org/ext/3.1.0/resources/css/ext-all.css" />
    <link rel="stylesheet" type="text/css" href="http://svn.geoext.org/ext/3.1.0/examples/shared/examples.css" /> 
    <script type="text/javascript" src="http://openlayers.org/api/2.8/OpenLayers.js"></script>
    <script type="text/javascript" src="../../../../../trunk/geoext/lib/GeoExt.js"></script>
    <script type="text/javascript"
            src="http://svn.geoext.org/extensions/geoext.ux/ux/GeoNamesSearchCombo/lib/GeoExt.ux/GeoNamesSearchCombo.js"></script>
    <script type="text/javascript" src="../../../ux/widgets/RoutingPanel.js"></script>
    <script type="text/javascript">
        function test_ctor(t) {
            t.plan(6);

            var layer = new OpenLayers.Layer.OSM("OSM");

            var map = new OpenLayers.Map('map');

            var center = new OpenLayers.LonLat(738481, 5863900);
            map.addLayer(layer);
            map.setCenter(center, 14);

            var routingPanel = new GeoExt.ux.RoutingPanel({
                renderTo: 'routingPanel',
                map: map,
                // Key for dev.geoext.org: 187a9f341f70406a8064d07a30e5695c
                // Key for localhost: BC9A493B41014CAABB98F0471D759707
                cloudmadeKey: '187a9f341f70406a8064d07a30e5695c',
                geocodingType: 'geonames',
                width: 100
            });

            t.ok(routingPanel instanceof GeoExt.ux.RoutingPanel,
                    "ctor creates a GeoExt.ux.RoutingPanel object");
            t.ok(routingPanel instanceof Ext.form.FormPanel,
                    "ctor creates an Ext.form.Panel object");

            t.eq(map.getCenter().toString(), "lon=738481,lat=5863900", "map center set correctly");
            t.eq(routingPanel.routingRecenterMap, true, "recenter on map is true per default");
            t.ok(routingPanel.routingPointDrawControl instanceof OpenLayers.Control.DrawFeature,
                    "routingPanel.routingPointDrawControl is an OpenLayers.Control.DrawFeature object");
            routingPanel.getItinerary();
            t.delay_call(2, function() {
                t.eq(routingPanel.routingStatusCloudmade, 0 , "routing has been computed with cloudmade");
                routingPanel.destroy();
            });

        }
    </script>
</head>
<body>
<div id="map"></div>
<div id="routingPanel"></div>
</body>
</html>

